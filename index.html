<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satoshi's Codex - Pro Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Cormorant+Garamond:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        :root {
            --primary-gold: #B8860B; /* DarkGoldenRod */
            --muted-orange: #D4AF37; /* Muted, antique gold */
            --bitcoin-orange: #F7931A;
            --black: #000000;
            --gray-dark: #101010;
            --gray-light: #1A1A1A;
            --text-primary: #EAEAEA;
            --text-secondary: #888888;
            --change-up: #22c55e;
            --change-down: #ef4444;
            --eth-color: #CCCCCC;
            --sol-color: #9945FF;
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--black);
            color: var(--text-primary);
            overflow-x: hidden;
            background-image: radial-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 0);
            background-size: 30px 30px;
        }
        
        .content-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 8rem 1rem;
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .content-section.visible { opacity: 1; transform: translateY(0); }
        
        .section-title {
            font-weight: 800;
            letter-spacing: -0.05em;
            background: linear-gradient(135deg, var(--text-primary) 40%, var(--primary-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding-bottom: 0.5rem;
        }
        .hero-title {
            background: linear-gradient(-45deg, var(--primary-gold), var(--text-primary), var(--muted-orange), var(--text-primary));
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-pan 10s ease infinite;
            line-height: 0.9;
        }
        @keyframes gradient-pan {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .carousel-container { position: relative; padding: 0 40px; }
        .carousel-wrapper { 
            overflow-x: auto;
            scroll-behavior: smooth;
            -ms-overflow-style: none;
            scrollbar-width: none;
            display: flex;
            padding-bottom: 1rem;
        }
        .carousel-wrapper::-webkit-scrollbar { display: none; }
        .carousel-track { 
            display: flex; 
            gap: 1.5rem;
        }

        .carousel-card { flex: 0 0 280px; background-color: var(--gray-light); border: 2px solid var(--gray-light); border-radius: 12px; padding: 2.5rem 1.5rem; cursor: pointer; transition: all 0.3s ease; text-align: center; position: relative; overflow: hidden; }
        .carousel-card:hover { transform: translateY(-8px) scale(1.05); border-color: var(--muted-orange); box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2); }
        .carousel-card.selected { background-color: var(--gray-light); color: var(--text-primary); border-color: var(--primary-gold); box-shadow: 0 0 20px rgba(184, 134, 11, 0.5); }
        .carousel-card img { width: 90px; height: 90px; border-radius: 50%; margin-bottom: 1rem; border: 2px solid var(--gray-dark); margin-left: auto; margin-right: auto; transition: border-color 0.3s ease; }
        .carousel-card.selected img { border-color: var(--primary-gold); }
        .carousel-card h3 { font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; }
        .carousel-card p { font-size: 0.875rem; opacity: 0.8; }

        .carousel-nav-btn {
            position: absolute;
            top: 45%;
            transform: translateY(-50%);
            z-index: 10;
            width: 44px;
            height: 44px;
            background-color: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(4px);
            color: var(--text-secondary);
            border-radius: 50%;
            border: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .carousel-nav-btn:hover {
            background-color: var(--primary-gold);
            color: var(--black);
            transform: translateY(-50%) scale(1.1);
        }
        .carousel-nav-btn#carousel-nav-left { left: 0; }
        .carousel-nav-btn#carousel-nav-right { right: 0; }

        .price-banner { background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(12px); overflow: hidden; white-space: nowrap; perspective: 500px; border-bottom: 1px solid var(--gray-light); font-family: 'Cambria', 'Cochin', 'Georgia', 'Times', 'Times New Roman', serif; }
        .banner-track { display: inline-block; animation: marquee 60s linear infinite; }
        .banner-segment { display: inline-flex; align-items: center; white-space: nowrap; }
        .banner-item { display: inline-flex; align-items: center; font-size: 1rem; font-weight: 600; transition: transform 0.3s ease; }
        .banner-item:hover { transform: translateY(-2px); }
        @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        
        .indicator-card { position: relative; background-color: rgba(0,0,0,0.3); border: 1px solid var(--gray-light); border-radius: 0.75rem; padding: 1rem; transition: all 0.3s ease; min-height: 120px; }
        .indicator-card:hover { transform: translateY(-4px); box-shadow: 0 0 20px rgba(184, 134, 11, 0.2); border-color: rgba(184, 134, 11, 0.5); }
        .indicator-description { max-height: 0; opacity: 0; overflow: hidden; transition: max-height 0.4s ease-out, opacity 0.4s ease-out, padding-top 0.4s ease-out, margin-top 0.4s ease-out; }
        .indicator-header:hover + .indicator-description { max-height: 150px; opacity: 1; padding-top: 0.5rem; margin-top: 0.5rem; }

        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(5px); animation: fadeIn 0.3s ease; align-items: center; justify-content: center; }
        .modal-content-container { width: 100%; max-width: 600px; }
        .modal-content { background-color: var(--gray-dark); padding: 2rem; border: 1px solid var(--gray-light); width: 100%; border-radius: 12px; animation: slideIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .btn { padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 600; text-align: center; cursor: pointer; transition: all 0.3s ease; border: none; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .btn-primary { background-color: var(--primary-gold); color: var(--black); }
        .btn-primary:hover { background-color: var(--muted-orange); transform: translateY(-2px); }
        .btn-secondary { background-color: var(--gray-light); color: var(--text-primary); border: 1px solid var(--gray-light); }
        .btn-secondary:hover { border-color: var(--primary-gold); transform: translateY(-2px); }
        .category-filter { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 2rem; justify-content: center; }
        .category-btn { padding: 0.5rem 1rem; border-radius: 2rem; border: 1px solid var(--gray-light); background-color: transparent; color: var(--text-primary); cursor: pointer; transition: all 0.3s ease; font-size: 0.875rem; }
        .category-btn:hover { border-color: var(--primary-gold); }
        .category-btn.active { background-color: var(--primary-gold); border-color: var(--primary-gold); color: var(--black); }
        
        .fab-container { position: fixed; bottom: 2rem; right: 2rem; z-index: 20; width: 80px; height: 80px; }
        .fab, .fab-secondary { position: absolute; width: 56px; height: 56px; background-color: var(--primary-gold); color: var(--black); border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.4); cursor: pointer; transition: all 0.3s ease; }
        .fab { top: 0; left: 0; z-index: 22; }
        .fab-secondary { bottom: 0; right: 0; z-index: 21; transform: scale(0); opacity: 0; transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        .fab-container.active .fab { transform: rotate(45deg); }
        .fab-container.active .fab-secondary { transform: scale(1); opacity: 1; }
        .fab:hover, .fab-secondary:hover { background-color: var(--muted-orange); }
        .fab-container.active .fab:hover { transform: rotate(45deg) scale(1.1); }
        
        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); }
        .form-input { width: 100%; padding: 0.75rem 1rem; background-color: var(--gray-light); border: 1px solid var(--gray-light); border-radius: 0.5rem; color: var(--text-primary); transition: border-color 0.3s ease; }
        .form-input:focus { outline: none; border-color: var(--primary-gold); }
        .text-gold { color: var(--primary-gold); }

        #menu-btn:hover span { background-color: var(--primary-gold); }
        #sidebar {
            background-color: var(--gray-dark);
            border-right: 1px solid var(--gray-light);
        }
        #sidebar.open { transform: translateX(0); }
        .sidebar-link {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 1.125rem;
            transition: color 0.3s ease, transform 0.3s ease;
            display: block;
            padding: 0.75rem 0.5rem;
            border-radius: 0.5rem;
        }
        .sidebar-link:hover {
            color: var(--primary-gold);
            background-color: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        .indicator-card.viewed {
            border-color: rgba(184, 134, 11, 0.4);
        }
        .indicator-card.viewed > div {
            transition: opacity 0.3s ease;
            opacity: 0.6;
        }
        .indicator-card.viewed:hover > div {
            opacity: 1;
        }
        .mark-viewed-btn .fa-check-circle {
            color: var(--primary-gold);
        }
        #reset-viewed-btn {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
        }

        #search-controls.active #indicator-search {
            width: 280px;
            opacity: 1;
            padding: 0.6rem 3.25rem 0.6rem 1rem;
            border-color: var(--primary-gold);
        }
        #search-controls #search-toggle:hover {
            color: var(--primary-gold);
        }
        #search-controls.active #search-toggle {
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <button id="menu-btn" class="fixed top-16 left-5 z-[60] p-2 space-y-1.5 bg-gray-dark/50 backdrop-blur-sm rounded-md border border-transparent hover:border-gray-light transition-all">
        <span class="block w-6 h-0.5 bg-white"></span>
        <span class="block w-6 h-0.5 bg-white"></span>
        <span class="block w-6 h-0.5 bg-white"></span>
    </button>

    <nav id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-gray-dark transform -translate-x-full transition-transform duration-300 ease-in-out z-50 p-6 pt-20">
        <h2 class="text-3xl font-bold text-gold mb-10" style="font-family: 'Cormorant Garamond', serif;">Satoshi's Codex</h2>
        <ul class="space-y-4">
            <li><a href="#hero" class="sidebar-link"><i class="fas fa-home w-6 mr-2"></i>Home</a></li>
            <li><a href="#x-feed" class="sidebar-link"><i class="fa-brands fa-x-twitter w-6 mr-2"></i>X Feed</a></li>
            <li><a href="#indicators" class="sidebar-link"><i class="fas fa-chart-line w-6 mr-2"></i>Indicators</a></li>
        </ul>
    </nav>
    
    <div class="price-banner py-2 sticky top-0 z-40"><div class="banner-track" id="banner-track"></div></div>
    <section class="content-section hero-section" id="hero"><div class="text-center max-w-4xl mx-auto"><h1 class="hero-title text-8xl md:text-9xl lg:text-[10rem] font-black mb-6">Satoshi's Codex</h1><div class="mt-16 flex justify-center"><div class="scroll-arrow animate-bounce text-gold" onclick="scrollToSection('x-feed')"><i class="fas fa-chevron-down text-5xl"></i></div></div></div></section>
    
    <section class="content-section" id="x-feed"><div class="w-full max-w-7xl mx-auto"><h2 class="section-title text-6xl md:text-7xl text-center mb-8">X Feed</h2><div class="carousel-container"><button id="carousel-nav-left" class="carousel-nav-btn"><i class="fas fa-chevron-left"></i></button><div class="carousel-wrapper"><div class="carousel-track" id="carousel-track"></div></div><button id="carousel-nav-right" class="carousel-nav-btn"><i class="fas fa-chevron-right"></i></button></div><div id="x-feed-container" class="mt-8 w-full max-w-lg mx-auto"></div></div></section>
    
    <section class="content-section" id="indicators"><div class="w-full max-w-7xl mx-auto relative">
        <h2 class="section-title text-6xl md:text-7xl text-center mb-8">Trading Indicators</h2>
        
        <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-8">
            <div id="search-controls" class="relative h-11">
                <input type="text" id="indicator-search" class="absolute top-0 right-0 h-full w-0 p-0 opacity-0 border-2 border-transparent rounded-full bg-gray-light text-text-primary focus:outline-none transition-all duration-300 ease-in-out" placeholder="Search indicators...">
                <button id="search-toggle" class="absolute top-0 right-0 h-11 w-11 flex items-center justify-center text-text-secondary rounded-full bg-gray-light transition-colors z-10">
                    <i class="fas fa-search search-open-icon"></i>
                    <i class="fas fa-times search-close-icon hidden"></i>
                </button>
            </div>
            <div id="progress-tracker" class="flex items-center gap-3 bg-gray-light px-4 py-2 rounded-lg">
                <span id="progress-text" class="font-semibold text-sm text-text-secondary">0%</span>
                <button id="reset-viewed-btn" class="text-sm text-gold hover:text-muted-orange font-semibold">Reset</button>
            </div>
        </div>

        <div class="category-filter"><button class="category-btn active" data-category="all">All</button><button class="category-btn" data-category="macro">Macro</button><button class="category-btn" data-category="sentiment">Sentiment</button><button class="category-btn" data-category="bitcoin">Bitcoin</button><button class="category-btn" data-category="ethereum">Ethereum</button><button class="category-btn" data-category="solana">Solana</button><button class="category-btn" data-category="on-chain">On-Chain</button><button class="category-btn" data-category="derivatives">Derivatives</button></div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="indicators-grid"></div>
    </div></section>
    
    <div id="add-choice-modal" class="modal"><div class="modal-content-container p-4"><div class="modal-content relative"><button type="button" onclick="closeModal('add-choice-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20"><i class="fas fa-times fa-lg"></i></button><h3 class="text-xl font-bold text-gold mb-6 text-center">What would you like to add?</h3><div class="flex justify-around gap-4"><button id="add-account-choice-btn" class="btn btn-primary w-full"><i class="fa-brands fa-x-twitter"></i> Account</button><button id="add-indicator-choice-btn" class="btn btn-secondary w-full"><i class="fas fa-chart-line"></i> Indicator</button></div></div></div></div>
    <div id="add-account-modal" class="modal"><div class="modal-content-container p-4"><form id="add-account-form" class="modal-content relative"><button type="button" onclick="closeModal('add-account-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20"><i class="fas fa-times fa-lg"></i></button><h3 class="text-xl font-bold text-gold mb-4">Add X Account</h3><div class="form-group"><label for="account-name" class="form-label">Account Name</label><input type="text" id="account-name" class="form-input" placeholder="e.g., Vitalik Buterin" required></div><div class="form-group"><label for="account-handle" class="form-label">X Handle (without @)</label><input type="text" id="account-handle" class="form-input" placeholder="e.g., VitalikButerin" required></div><button type="submit" class="btn btn-primary w-full justify-center">Add Account</button></form></div></div>
    
    <div id="add-indicator-modal" class="modal"><div class="modal-content-container p-4"><form id="add-indicator-form" class="modal-content relative"><button type="button" onclick="closeModal('add-indicator-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20"><i class="fas fa-times fa-lg"></i></button><h3 class="text-xl font-bold text-gold mb-4">Add Custom Indicator</h3><div class="form-group"><label for="indicator-name" class="form-label">Indicator Name</label><input type="text" id="indicator-name" class="form-input" placeholder="e.g., My Custom Index" required></div><div class="form-group"><label for="indicator-url" class="form-label">External URL</label><input type="url" id="indicator-url" class="form-input" placeholder="https://example.com/my-chart" required></div><div class="form-group"><label for="indicator-category" class="form-label">Category</label><input type="text" id="indicator-category" class="form-input" placeholder="e.g., on-chain" required></div><div class="form-group"><label for="indicator-desc" class="form-label">Description</label><textarea id="indicator-desc" class="form-input" rows="2" placeholder="A brief description of the indicator."></textarea></div><div class="form-group"><label for="indicator-signal" class="form-label">Trading Signal (Optional)</label><input type="text" id="indicator-signal" class="form-input" placeholder="e.g., Buy below green, Sell above red"></div><button type="submit" class="btn btn-primary w-full justify-center">Add Indicator</button></form></div></div>
    
    <div class="fab-container"><button id="global-fab" class="fab"><i class="fab fa-bitcoin"></i></button><button id="add-fab" class="fab-secondary"><i class="fas fa-plus"></i></button></div>

    <script>
        const API_BASE_URL = 'https://api.coingecko.com/api/v3';
        // UPDATED: Removed specified indicators
        let INDICATORS = [ { id: 'cme-fedwatch', name: 'CME FedWatch Tool', category: 'macro', description: 'Tracks interest rate probabilities.', icon: 'fas fa-landmark', externalUrl: 'https://www.cmegroup.com/markets/interest-rates/cme-fedwatch-tool.html' }, { id: 'market-hours', name: 'Market Hours', category: 'macro', description: 'Global stock market opening hours.', icon: 'fas fa-clock', externalUrl: 'https://www.degiro.pt/centro-de-conhecimento/informacao-das-bolsas/horario-de-abertura' }, { id: 'polymarket', name: 'Polymarket', category: 'sentiment', description: 'Prediction markets for various events.', icon: 'fas fa-vote-yea', externalUrl: 'https://polymarket.com/' }, { id: 'crypto-calendar', name: 'Crypto Events Calendar', category: 'macro', description: 'Upcoming events in the crypto space.', icon: 'fas fa-calendar-alt', externalUrl: 'https://coinmarketcap.com/events/' }, { id: 'btc-yearly-returns', name: 'BTC Yearly Returns', category: 'bitcoin', description: "Bitcoin's annual performance over the last 10 years.", icon: 'fas fa-chart-line', externalUrl: 'https://www.statmuse.com/money/ask/bitcoin-yearly-returns-last-10-years' }, { id: 'btc-halving-cycle', name: 'Bitcoin Halving Cycle', category: 'bitcoin', description: "Price chart showing Bitcoin's epoch cycles.", icon: 'fas fa-recycle', externalUrl: 'https://charts.checkonchain.com/btconchain/technical/technical_epochcycle_price_0/technical_epochcycle_price_0_light.html' }, { id: 'altcoin-season-1', name: 'Altcoin Season Index #1', category: 'sentiment', description: "Blockchain Center's Altcoin Season Index.", icon: 'fas fa-chart-pie', externalUrl: 'https://www.blockchaincenter.net/en/altcoin-season-index/' }, { id: 'altcoin-season-2', name: 'Altcoin Season Index #2', category: 'sentiment', description: "Coinglass's Altcoin Season Index.", icon: 'fas fa-chart-pie', externalUrl: 'https://www.coinglass.com/pt/pro/i/alt-coin-season' }, { id: 'btc-funding-rates', name: 'Bitcoin Funding Rates', category: 'derivatives', description: 'Funding rates across all exchanges.', icon: 'fas fa-percentage', externalUrl: 'https://cryptoquant.com/asset/btc/chart/derivatives/funding-rates?exchange=all_exchange&window=DAY&sma=0&ema=0&priceScale=log&metricScale=linear&chartStyle=column' }, { id: 'cbbi', name: 'Bitcoin Bull Run Index (CBBI)', category: 'bitcoin', description: 'The ColinTalksCrypto Bitcoin Bull Run Index.', icon: 'fas fa-tachometer-alt', externalUrl: 'https://colintalkscrypto.com/cbbi/' }, { id: 'hyperliquid-liquidation-map', name: 'Hyperliquid Liquidation Map', category: 'derivatives', description: 'Liquidation map for Hyperliquid.', icon: 'fas fa-map-marked-alt', externalUrl: 'https://www.coinglass.com/hyperliquid-liquidation-map' }, { id: 'btc-liquidation-map', name: 'BTC Exchange Liquidation Map', category: 'derivatives', description: 'Consolidated liquidation map for Bitcoin.', icon: 'fas fa-map-marked-alt', externalUrl: 'https://www.coinglass.com/pro/futures/LiquidationMap' }, { id: 'stock-to-flow', name: 'Stock-to-Flow Model', category: 'bitcoin', description: 'Shows which part of the BTC cycle we are in.', icon: 'fas fa-stream', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/stock-to-flow-model/' }, { id: 'fear-and-greed', name: 'Fear and Greed Index', category: 'sentiment', description: 'Buy on Extreme Fear, consider selling/borrowing on Extreme Greed.', icon: 'fas fa-heart-pulse', externalUrl: 'https://coinmarketcap.com/charts/fear-and-greed-index/' }, { id: 'btc-market-peaks', name: 'BTC Market Peaks', category: 'bitcoin', description: 'Dashboard for identifying market peaks.', icon: 'fas fa-mountain', externalUrl: 'https://charts.bgeometrics.com/dashboard_market_peaks.html' }, { id: 'bvrs-trend', name: 'BVRS - Trend Component', category: 'on-chain', description: 'Red for downtrend (buy), Green for uptrend (sell).', icon: 'fas fa-directions', externalUrl: 'https://alphaextract.webflow.io/charts/bvrs-trend' }, { id: 'ahr999-index', name: 'AHR999 Index', category: 'bitcoin', description: 'An index for timing Bitcoin buys.', icon: 'fas fa-sort-numeric-up', externalUrl: 'https://www.coinglass.com/pt/pro/i/ahr999' }, { id: 'btc-market-drawdown', name: 'Bitcoin Market Drawdown', category: 'bitcoin', description: 'Visualizes drawdowns from all-time highs.', icon: 'fas fa-chart-area', externalUrl: 'https://charts.checkonchain.com/btconchain/technical/technical_drawdowns_0/technical_drawdowns_0_light.html' }, { id: 'bvrs-dynamic', name: 'BVRS - Dynamic Range', category: 'on-chain', description: 'Buy when below -2.00, Sell when above 2.00.', icon: 'fas fa-arrows-alt-v', externalUrl: 'https://alphaextract.webflow.io/charts/bvrs-dynamic' }, { id: 'intra-cycle-valuation', name: 'Intra-Cycle Valuation', category: 'on-chain', description: 'Sell at red line, buy below green line.', icon: 'fas fa-wave-square', externalUrl: 'https://alphaextract.webflow.io/charts/intra-cycle' }, { id: 'btc-volume-messari', name: 'Bitcoin Volume (Messari)', category: 'on-chain', description: "Bitcoin's trading volume.", icon: 'fas fa-chart-bar', externalUrl: 'https://messari.io/project/bitcoin/charts/market/chart/volume' }, { id: 'perp-spot-gap', name: 'Perp-Spot Price Gap', category: 'derivatives', description: 'Price difference between perpetual futures and spot markets.', icon: 'fas fa-exchange-alt', externalUrl: 'https://cryptoquant.com/analytics/query/6605b2e03868645bdfa05a25?v=6605b4553177430cdc6b80fe' }, { id: 'miner-pl-sustainability', name: 'Miner P/L Sustainability', category: 'on-chain', description: 'Profitability and sustainability of Bitcoin miners.', icon: 'fas fa-pickaxe', externalUrl: 'https://cryptoquant.com/analytics/query/651ae2fb3710027f292135ae?v=651ae5993710027f292135b2' }, { id: 'ae-cycle-bands', name: 'AE Cycle Bands', category: 'on-chain', description: 'Below green suggests bottom, above red suggests top.', icon: 'fas fa-compress-arrows-alt', externalUrl: 'https://alphaextract.webflow.io/charts/cycle-bands' }, { id: 'aasi-sentiment', name: 'AASI Sentiment', category: 'sentiment', description: 'Orange line crossing red (sell) or green (buy).', icon: 'fas fa-users', externalUrl: 'https://alphaextract.webflow.io/charts/aasi' }, { id: 'lth-supply-vs-flows', name: 'LTH Supply vs ETF & MSTR', category: 'on-chain', description: 'Long-term holder supply vs institutional flows.', icon: 'fas fa-layer-group', externalUrl: 'https://cryptoquant.com/analytics/query/675574c4494b0e68b4859434?v=675574c4494b0e68b4859436' }, { id: 'btc-futures-volume-monthly', name: 'BTC Futures Volume (Monthly)', category: 'derivatives', description: 'Monthly volume of Bitcoin futures.', icon: 'fas fa-chart-bar', externalUrl: 'https://www.theblock.co/data/crypto-markets/futures/volume-of-bitcoin-futures-monthly' }, { id: 'btc-eth-futures-volume', name: 'BTC & ETH Futures Volume (7D MA)', category: 'derivatives', description: '7-day moving average of futures volume.', icon: 'fas fa-chart-bar', externalUrl: 'https://www.theblock.co/data/crypto-markets/futures/btc-and-eth-futures-volume-7dma' }, { id: 'vdd-multiple', name: 'Value Days Destroyed Multiple', category: 'on-chain', description: 'Above 2.0 sell, below 0.8 buy.', icon: 'fas fa-fire-alt', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/value-days-destroyed-multiple/' }, { id: 'pi-cycle-top', name: 'Pi Cycle Top Indicator', category: 'on-chain', description: 'Near green to sell, below orange to buy.', icon: 'fas fa-calculator', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/pi-cycle-top-indicator/' }, { id: 'sth-price-discovery', name: 'STH Price Discovery (Fib)', category: 'on-chain', description: 'Short-term holder price models.', icon: 'fas fa-search-dollar', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/pricediscovery/pricediscovery_light.html' }, { id: 'macd-chart', name: 'MACD Chart', category: 'on-chain', description: 'Moving Average Convergence Divergence.', icon: 'fas fa-signal', externalUrl: 'https://charts.checkonchain.com/btconchain/technical/technical_macd/technical_macd_light.html' }, { id: 'cycle-extreme-oscillators', name: 'Cycle Extreme Oscillators', category: 'on-chain', description: 'Confluence of cycle oscillators.', icon: 'fas fa-sliders-h', externalUrl: 'https://charts.checkonchain.com/btconchain/confluence/confluence_cycleextremeoscillators_1/confluence_cycleextremeoscillators_1_light.html' }, { id: 'btc-monthly-performance', name: 'BTC Monthly Performance', category: 'bitcoin', description: "Table of Bitcoin's monthly price performance.", icon: 'fas fa-table', externalUrl: 'https://charts.checkonchain.com/btconchain/technical/technical_table_monthlyperf_price/technical_table_monthlyperf_price_light.html' }, { id: 'on-chain-originals', name: 'On-Chain Originals Price Models', category: 'on-chain', description: 'Original on-chain price models.', icon: 'fas fa-project-diagram', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/pricing_onchainoriginals/pricing_onchainoriginals_light.html' }, { id: 'key-cost-basis', name: 'Key Cost Basis Models', category: 'on-chain', description: 'Price models based on key cost basis.', icon: 'fas fa-key', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/pricing_costbasisoriginals/pricing_costbasisoriginals_light.html' }, { id: 'topping-models', name: 'Topping Price Models', category: 'on-chain', description: 'Models for identifying market tops.', icon: 'fas fa-level-up-alt', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/topmodels/topmodels_light.html' }, { id: 'realised-pl-momentum', name: 'Realised P/L Momentum', category: 'on-chain', description: 'Momentum of realized profits and losses.', icon: 'fas fa-rocket', externalUrl: 'https://charts.checkonchain.com/btconchain/realised/signal_realisedpnl_momentum_all/signal_realisedpnl_momentum_all_light.html' }, { id: 'sell-side-risk-ratio', name: 'Sell-Side Risk Ratio', category: 'on-chain', description: 'Risk assessment from the sell-side.', icon: 'fas fa-exclamation-triangle', externalUrl: 'https://charts.checkonchain.com/btconchain/realised/sellsideriskratio_all/sellsideriskratio_all_light.html' }, { id: 'mayer-multiple', name: 'The Mayer Multiple', category: 'on-chain', description: 'Price divided by 200-day moving average.', icon: 'fas fa-divide', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/pricing_mayermultiple/pricing_mayermultiple_light.html' }, { id: 'coin-days-destroyed', name: 'Bitcoin: Coin Days Destroyed', category: 'bitcoin', description: 'Measures the economic significance of transactions.', icon: 'fas fa-calendar-day', externalUrl: 'https://charts.bgeometrics.com/cdd.html' }, { id: 'btc-funding-rates-perps', name: 'Bitcoin Funding Rates (Perps)', category: 'derivatives', description: 'Funding rates for perpetual swaps.', icon: 'fas fa-history', externalUrl: 'https://charts.checkonchain.com/btconchain/derivatives/derivatives_futures_fundingrate/derivatives_futures_fundingrate_light.html' }, { id: 'euphoria-zone', name: 'Bitcoin: The Euphoria Zone', category: 'bitcoin', description: 'Glassnode chart showing market euphoria.', icon: 'fas fa-grin-stars', externalUrl: 'https://studio.glassnode.com/charts/178a2882-7af5-4b6b-5764-b4702e631acb' }, { id: 'sell-side-risk-vs-vol', name: 'Sell-Side Risk vs Option Volatility', category: 'derivatives', description: 'Compares sell-side risk to implied volatility.', icon: 'fas fa-chart-line', externalUrl: 'https://charts.checkonchain.com/btconchain/realised/sellsideriskratio_all_impliedvol/sellsideriskratio_all_impliedvol_light.html' }, { id: 'nupl-chart', name: 'Net Unrealised Profit/Loss (NUPL)', category: 'on-chain', description: 'Net profit/loss as a percentage of market cap.', icon: 'fas fa-percentage', externalUrl: 'https://charts.checkonchain.com/btconchain/unrealised/nupl/nupl_light.html' }, { id: 'capital-rotation', name: 'Capital Rotation Net Position Change', category: 'on-chain', description: 'Tracks capital flow between cohorts.', icon: 'fas fa-sync-alt', externalUrl: 'https://charts.checkonchain.com/btconchain/capitalrotation/capitalrotation_netposchange/capitalrotation_netposchange_light.html' }, { id: 'nupl-by-cohort', name: 'NUPL by Cohort', category: 'on-chain', description: 'Blue to buy, orange indicates a local top.', icon: 'fas fa-users-cog', externalUrl: 'https://charts.checkonchain.com/btconchain/unrealised/nupl_bycohort/nupl_bycohort_light.html' }, { id: 'shark-whale-balance', name: 'Sharks & Whales Balance', category: 'on-chain', description: 'Balance of large Bitcoin holders on exchanges.', icon: 'fas fa-fish', externalUrl: 'https://charts.checkonchain.com/btconchain/supply/distribution_sharkwhalexchange_30/distribution_sharkwhalexchange_30_light.html' }, { id: 'lth-supply', name: 'Long-Term Holder Supply', category: 'on-chain', description: 'Percentage of supply held by long-term holders.', icon: 'fas fa-shield-alt', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/long-term-holder-supply/' }, { id: 'lth-realized-price', name: 'Long-Term Holder Realized Price', category: 'on-chain', description: 'Closer to the line is a better buy moment.', icon: 'fas fa-anchor', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/long-term-holder-realized-price' }, { id: 'bvrs-system', name: 'Bitcoin Value Range System', category: 'on-chain', description: 'Green zone indicates extreme bottoms.', icon: 'fas fa-check-circle', externalUrl: 'https://alphaextract.webflow.io/charts/bvrs' }, { id: 'mvrv-z-score', name: 'MVRV Z-Score', category: 'on-chain', description: 'Green zone is a good buy signal in bear markets.', icon: 'fas fa-thermometer-quarter', externalUrl: 'https://charts.checkonchain.com/btconchain/unrealised/mvrv_all_zscore/mvrv_all_zscore_light.html' }, { id: 'btc-delta-top', name: 'Bitcoin Delta Top', category: 'bitcoin', description: 'Model to identify Bitcoin market tops.', icon: 'fas fa-delta', externalUrl: 'https://www.bitcoinmagazinepro.com/charts/delta-top/' }, { id: 'pi-cycle-top-2', name: 'Pi Cycle Top Indicator (CheckOnChain)', category: 'on-chain', description: 'Identifies the cycle top.', icon: 'fas fa-calculator', externalUrl: 'https://charts.checkonchain.com/btconchain/pricing/pricing_picycleindicator/pricing_picycleindicator_light.html' }, { id: 'sth-mvrv-bollinger', name: 'STH MVRV Bollinger Bands', category: 'on-chain', description: 'Short-term holder MVRV with Bollinger Bands.', icon: 'fas fa-chart-line', externalUrl: 'https://charts.checkonchain.com/btconchain/unrealised/sthsoprmvrv_indicator/sthsoprmvrv_indicator_light.html' }, { id: 'sth-mvrv-sopr', name: 'STH MVRV and SOPR', category: 'on-chain', description: 'Short-term holder MVRV and SOPR.', icon: 'fas fa-chart-line', externalUrl: 'https://charts.checkonchain.com/btconchain/unrealised/sthmvrv_indicator/sthmvrv_indicator_light.html' }, { id: 'nupl-cycle-top', name: 'NUPL for Cycle Tops/Bottoms', category: 'on-chain', description: 'Used to identify cycle tops and bottoms.', icon: 'fas fa-crosshairs', externalUrl: 'https://charts.checkonchain.com/btconchain/cointime/nupl_aviv/nupl_aviv_light.html' }, { id: 'nrpl-cryptoquant', name: 'Net Realized Profit and Loss (NRPL)', category: 'on-chain', description: 'Net realized profit and loss.', icon: 'fas fa-balance-scale-right', externalUrl: 'https://cryptoquant.com/asset/btc/chart/network-indicator/net-realized-profit-and-loss?window=DAY&sma=0&ema=0&priceScale=log&metricScale=linear&chartStyle=line' }, { id: 'nrpl-bgeometrics', name: 'Net Realized Profit/Loss', category: 'on-chain', description: 'Chart of net realized profit and loss.', icon: 'fas fa-balance-scale-left', externalUrl: 'https://charts.bgeometrics.com/nrpl.html' }, { id: 'btc-price-models-woo', name: 'Bitcoin Price Models (WooCharts)', category: 'bitcoin', description: 'Models for finding cycle tops and bottoms.', icon: 'fas fa-bullseye', externalUrl: 'https://woocharts.com/bitcoin-price-models/' }, { id: 'retail-demand', name: 'BTC: Retail Investor Demand (30D)', category: 'sentiment', description: 'Demand from retail investors over 30 days.', icon: 'fas fa-shopping-cart', externalUrl: 'https://cryptoquant.com/community/dashboard/669a09010a078b098ff284fc' }, { id: 'eth-etf-flows', name: 'ETH ETFs Net Flow', category: 'ethereum', description: 'Net flows for Ethereum ETFs.', icon: 'fas fa-exchange-alt', externalUrl: 'https://coinmarketcap.com/etf/ethereum/' }, { id: 'etf-flows-soso', name: 'ETFs Net Flow (SosoValue)', category: 'macro', description: 'US BTC spot ETF net flows.', icon: 'fas fa-university', externalUrl: 'https://sosovalue.com/pt/assets/etf/us-btc-spot' }, { id: 'eth-liquidity-bands', name: 'Global Liquidity Bands and ETH Price', category: 'ethereum', description: 'Buy when ETH price is below the green band.', icon: 'fas fa-water', externalUrl: 'https://alphaextract.webflow.io/charts/liquidity-eth-bands' }, { id: 'eth-total-staked', name: 'Ethereum: Total Value Staked', category: 'ethereum', description: "Sell when white line touches blue; buy when it's far below.", icon: 'fas fa-lock', externalUrl: 'https://cryptoquant.com/asset/eth/chart/eth2/total-value-staked?window=DAY&priceScale=log&metricScale=linear&chartStyle=line&sma=0&ema=0' }, { id: 'eth-accumulation', name: 'ETH Accumulation', category: 'ethereum', description: 'Tracks the accumulation of Ethereum.', icon: 'fas fa-cubes', externalUrl: 'https://cryptoquant.com/analytics/query/66e5e9e042286374a3636ede' }, { id: 'eth-mvrv', name: 'Ethereum: MVRV Ratio', category: 'ethereum', description: 'Sell above 1.5, buy below 0.8.', icon: 'fas fa-balance-scale', externalUrl: 'https://cryptoquant.com/analytics/query/64b514efd3b74754036eab78?v=64b514efd3b74754036eab7a' }, { id: 'sol-volume', name: 'Solana Volume', category: 'solana', description: 'Trading volume for Solana.', icon: 'fas fa-chart-bar', externalUrl: 'https://messari.io/project/solana/charts/market/chart/volume' }, { id: 'sol-funding-oi', name: 'Solana Funding Rate & OI', category: 'solana', description: 'Funding rates and open interest for Solana.', icon: 'fas fa-file-invoice-dollar', externalUrl: 'https://messari.io/project/solana/charts/market/chart/funding-rate-open-interest' }, { id: 'sol-funding-volume', name: 'Solana Funding Rate Volume', category: 'solana', description: 'Volume associated with funding rates.', icon: 'fas fa-money-bill-wave', externalUrl: 'https://messari.io/project/solana/charts/market/chart/funding-rate-volume' }, { id: 'sol-volume-defillama', name: 'Solana Chain Token Volume (DeFiLlama)', category: 'solana', description: 'Token volume on the Solana chain.', icon: 'fas fa-truck-loading', externalUrl: 'https://defillama.com/chain/solana?stables=false&txs=false&perps=false&appFees=false&inflows=false&chainFees=false&chainRevenue=false&appRevenue=false&chainTokenVolume=true' }, { id: 'sol-perps-volume', name: 'Solana Perps Volume (DeFiLlama)', category: 'solana', description: 'Perpetual swaps volume on Solana.', icon: 'fas fa-sync', externalUrl: 'https://defillama.com/chain/solana?stables=false&txs=false&perps=true&appFees=false&inflows=false&chainFees=false&chainRevenue=false&appRevenue=false&chainTokenVolume=false' }, { id: 'sol-onchain-metrics', name: 'Solana On-Chain Metrics (The Block)', category: 'solana', description: 'Various on-chain metrics for Solana.', icon: 'fas fa-cogs', externalUrl: 'https://www.theblock.co/data/on-chain-metrics/solana' } ];
        let X_ACCOUNTS = [ { id: 'AugustoBackes', name: 'Augusto Backes', handle: '@AugustoBackes' }, { id: 'JoshMandell6', name: 'Josh Mandell', handle: '@JoshMandell6' }, { id: 'CryptoHayes', name: 'Arthur Hayes', handle: '@CryptoHayes' }, { id: 'DanielLCDuarte', name: 'Daniel Duarte', handle: '@DanielLCDuarte' }, { id: 'hi_disruptivas', name: 'Disruptivas', handle: '@hi_disruptivas' }, { id: 'Investidor420', name: 'Investidor420', handle: '@Investidor420' }, { id: 'castacrypto', name: 'CastaCrypto', handle: '@castacrypto' }, { id: 'victor__alfa', name: 'Victor Alfa', handle: '@victor__alfa' }, { id: 'rodrigomcrypto', name: 'RodrigoM.eth', handle: '@rodrigomcrypto' }, { id: 'joao_wedson', name: 'João Wedson', handle: '@joao_wedson' }, { id: 'fernandoulrich', name: 'Fernando Ulrich', handle: '@fernandoulrich' }, { id: 'Felipether', name: 'Felipe Santana', handle: '@Felipether' }, { id: 'RennoGuil', name: 'Guilherme Renó', handle: '@RennoGuil' }, { id: 'JA_Maartun', name: 'Maartunn', handle: '@JA_Maartun' }, { id: 'WatcherGuru', name: 'Watcher.Guru', handle: '@WatcherGuru' }, { id: 'rovercrc', name: 'Rover', handle: '@rovercrc' }, { id: 'saylor', name: 'Michael Saylor', handle: '@saylor' }, { id: 'ParadigmaEdu', name: 'Paradigma Education', handle: '@ParadigmaEdu' }, { id: 'KobeissiLetter', name: 'The Kobeissi Letter', handle: '@KobeissiLetter' }, { id: 'bravosresearch', name: 'Bravos Research', handle: '@bravosresearch' }, { id: 'PositiveCrypto', name: 'Positive Crypto', handle: '@PositiveCrypto' }, { id: 'Alphractal', name: 'Alphractal', handle: '@Alphractal' }, { id: 'coinglass_com', name: 'Coinglass', handle: '@coinglass_com' }, { id: 'cryptoquant_com', name: 'CryptoQuant.com', handle: '@cryptoquant_com' }, { id: 'alphaextract_', name: 'Alpha Extract', handle: '@alphaextract_' }, { id: 'ecoinometrics', name: 'Ecoinometrics', handle: '@ecoinometrics' } ];
        let currentCarouselIndex = 0, selectedAccount = null, indicatorsData = [], filteredIndicators = [], chartInstance = null;
        let viewedIndicators = [];

        document.addEventListener('DOMContentLoaded', () => { loadDataFromStorage(); initializePriceBanner(); initializeCarousel(); initializeIndicators(); initializeScrollAnimations(); initializeEventListeners(); startDataUpdates(); });
        
        function loadDataFromStorage() { 
            try { 
                const savedAccounts = localStorage.getItem('satoshisCodexAccounts'); 
                if (savedAccounts) X_ACCOUNTS = JSON.parse(savedAccounts); 
                
                const savedIndicators = localStorage.getItem('satoshisCodexIndicators'); 
                if (savedIndicators) INDICATORS = JSON.parse(savedIndicators);

                const savedViewed = localStorage.getItem('satoshisCodexViewedIndicators');
                if (savedViewed) viewedIndicators = JSON.parse(savedViewed);

            } catch (error) { 
                console.error("Failed to load from localStorage:", error); 
            } 
            selectedAccount = X_ACCOUNTS[0]?.id; 
            indicatorsData = [...INDICATORS]; 
            filteredIndicators = [...indicatorsData]; 
            updateProgress();
        }

        function saveData(key, data) { try { localStorage.setItem(key, JSON.stringify(data)); } catch (error) { console.error(`Failed to save to localStorage (key: ${key}):`, error); } }
        function startDataUpdates() { setInterval(updatePriceBanner, 60000); }
        function initializePriceBanner() { updatePriceBanner(); }
        async function updatePriceBanner() {
            const bannerTrack = document.getElementById('banner-track');
            if (!bannerTrack) return;
            try {
                const coinIds = ['bitcoin', 'ethereum', 'solana'];
                const priceResponse = await fetch(`${API_BASE_URL}/simple/price?ids=${coinIds.join(',')}&vs_currencies=usd&include_24hr_change=true`);
                if (!priceResponse.ok) throw new Error('Failed to fetch crypto prices');
                const prices = await priceResponse.json();
                const fngResponse = await fetch('https://api.alternative.me/fng/?limit=1');
                if (!fngResponse.ok) throw new Error('Failed to fetch Fear & Greed index');
                const fngData = await fngResponse.json(), fng = fngData.data[0];
                let segmentHTML = '';
                const btc = prices['bitcoin']; if (btc) { const changeClass = btc.usd_24h_change >= 0 ? `color: var(--change-up);` : `color: var(--change-down);`, changeIcon = btc.usd_24h_change >= 0 ? '▲' : '▼'; segmentHTML += `<span class="banner-item" style="color: var(--bitcoin-orange);">BTC: $${btc.usd.toLocaleString()}<span style="${changeClass}" class="ml-1">${changeIcon}${Math.abs(btc.usd_24h_change).toFixed(2)}%</span></span>`; }
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                const eth = prices['ethereum']; if (eth) { const changeClass = eth.usd_24h_change >= 0 ? `color: var(--change-up);` : `color: var(--change-down);`, changeIcon = eth.usd_24h_change >= 0 ? '▲' : '▼'; segmentHTML += `<span class="banner-item" style="color: var(--eth-color);">ETH: $${eth.usd.toLocaleString()}<span style="${changeClass}" class="ml-1">${changeIcon}${Math.abs(eth.usd_24h_change).toFixed(2)}%</span></span>`; }
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                const sol = prices['solana']; if (sol) { const changeClass = sol.usd_24h_change >= 0 ? `color: var(--change-up);` : `color: var(--change-down);`, changeIcon = sol.usd_24h_change >= 0 ? '▲' : '▼'; segmentHTML += `<span class="banner-item" style="color: var(--sol-color);">SOL: $${sol.usd.toLocaleString()}<span style="${changeClass}" class="ml-1">${changeIcon}${Math.abs(sol.usd_24h_change).toFixed(2)}%</span></span>`; }
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                let fngColor; switch (fng.value_classification) { case 'Greed': case 'Extreme Greed': fngColor = 'var(--change-down)'; break; case 'Fear': case 'Extreme Fear': fngColor = 'var(--change-up)'; break; default: fngColor = 'var(--muted-orange)'; } segmentHTML += `<span class="banner-item" style="color: ${fngColor};">F&G: ${fng.value} ${fng.value_classification}</span>`;
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                bannerTrack.innerHTML = `<div class="banner-segment">${segmentHTML}</div><div class="banner-segment">${segmentHTML}</div>`;
            } catch (error) { console.error('Error updating price banner:', error); bannerTrack.innerHTML = `<div class="banner-segment"><span class="banner-item text-red-500">Failed to load live data.</span></div>`; }
        }
        
        function initializeCarousel() { 
            const track = document.getElementById('carousel-track'); 
            if (!track) return; 
            const originalHTML = X_ACCOUNTS.map(acc => `<div class="carousel-card ${acc.id === selectedAccount ? 'selected' : ''}" data-account="${acc.id}" onclick="selectAccount('${acc.id}', this)"><img src="https://unavatar.io/x/${acc.id}" alt="${acc.name}" onerror="this.onerror=null;this.src='https://placehold.co/80x80/1A1A1A/EAEAEA?text=${acc.name.charAt(0)}';"><h3>${acc.name}</h3><p>${acc.handle}</p></div>`).join(''); 
            track.innerHTML = originalHTML; 
            if (selectedAccount) selectAccount(selectedAccount); 
        }
        
        function selectAccount(id, el) { 
            selectedAccount = id; 
            document.querySelectorAll('.carousel-card').forEach(c => c.classList.remove('selected')); 
            const cards = document.querySelectorAll(`[data-account="${id}"]`); 
            cards.forEach(card => card.classList.add('selected')); 
            const container = document.getElementById('x-feed-container');
            const info = X_ACCOUNTS.find(acc => acc.id === id); 
            if (!info) { 
                container.innerHTML = `<p class="text-center text-red-400">Account not found.</p>`; 
                return; 
            } 
            container.innerHTML = `<div id="timeline-wrapper"><a class="twitter-timeline" data-theme="dark" data-tweet-limit="5" data-height="500" data-chrome="noheader nofooter noborders transparent" href="https://twitter.com/${info.id}?ref_src=twsrc%5Etfw"></a></div><div class="mt-4 text-center"><a href="https://twitter.com/${info.id}" target="_blank" rel="noopener noreferrer" class="btn btn-primary" style="padding: 1rem;" title="View on X"><i class="fa-brands fa-x-twitter fa-2x"></i></a></div>`; 
            if (typeof twttr !== 'undefined') twttr.ready(t => t.widgets.load(container)); 
        }

        function scrollCarousel(direction) {
            const wrapper = document.querySelector('.carousel-wrapper');
            if (!wrapper) return;
            const card = wrapper.querySelector('.carousel-card');
            if (!card) return;

            const scrollAmount = card.offsetWidth + 24;
            wrapper.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }

        function initializeIndicators() { renderIndicators(); }
        
        function updateProgress() {
            const progressText = document.getElementById('progress-text');
            if (!progressText || indicatorsData.length === 0) return;
            const percentage = Math.round((viewedIndicators.length / indicatorsData.length) * 100);
            progressText.textContent = `${percentage}%`;
        }
        
        function renderIndicators() {
            const grid = document.getElementById('indicators-grid');
            if (!grid) return;
            grid.innerHTML = filteredIndicators.length ?
                filteredIndicators.map(ind => {
                    const isViewed = viewedIndicators.includes(ind.id);
                    return `
                    <div class="indicator-card flex flex-col justify-between ${isViewed ? 'viewed' : ''}" data-card-id="${ind.id}">
                        <div>
                            <div class="indicator-header flex items-center justify-between">
                                <div class="flex items-center gap-3 cursor-help">
                                    <i class="${ind.icon || 'fas fa-link'} text-gold text-xl"></i>
                                    <h3 class="font-semibold text-base">${ind.name}</h3>
                                </div>
                                <div class="flex items-center gap-3">
                                     <button class="mark-viewed-btn p-1 text-gray-400 hover:text-gold" data-indicator-id="${ind.id}" title="Mark as viewed">
                                        <i class="fas ${isViewed ? 'fa-check-circle' : 'fa-circle'} text-lg"></i>
                                    </button>
                                    <i class="fas fa-info-circle text-gray-400 text-lg cursor-help"></i>
                                </div>
                            </div>
                            <div class="indicator-description">
                                <p class="text-sm text-gray-400 border-t border-gray-800 pt-2">
                                    ${ind.description || 'No description available.'}
                                </p>
                            </div>
                        </div>
                        <div class="mt-4 text-right">
                            <button onclick="window.open('${ind.externalUrl}', '_blank')" class="text-gold hover:text-muted-orange text-sm font-semibold">
                                View <i class="fas fa-external-link-alt ml-1"></i>
                            </button>
                        </div>
                    </div>`;
                }).join('') :
                `<p class="text-center col-span-full text-gray-400">No indicators found.</p>`;
        }
        function initializeEventListeners() {
            document.getElementById('indicator-search').addEventListener('input', handleSearch);
            document.querySelectorAll('.category-btn').forEach(btn => btn.addEventListener('click', () => handleCategoryFilter(btn.dataset.category)));
            window.addEventListener('click', e => { if (e.target.classList.contains('modal')) closeModal(e.target.id); });
            
            const fabContainer = document.querySelector('.fab-container');
            const mainFab = document.getElementById('global-fab');
            const addFab = document.getElementById('add-fab');

            mainFab.addEventListener('click', () => {
                fabContainer.classList.toggle('active');
            });
            addFab.addEventListener('click', () => {
                document.getElementById('add-choice-modal').style.display = 'flex';
                fabContainer.classList.remove('active');
            });
            
            document.getElementById('add-account-choice-btn').addEventListener('click', () => { closeModal('add-choice-modal'); document.getElementById('add-account-modal').style.display = 'flex'; });
            document.getElementById('add-indicator-choice-btn').addEventListener('click', () => { closeModal('add-choice-modal'); document.getElementById('add-indicator-modal').style.display = 'flex'; });
            document.getElementById('add-account-form').addEventListener('submit', e => { e.preventDefault(); const name = document.getElementById('account-name').value, handle = document.getElementById('account-handle').value; if (name && handle) { X_ACCOUNTS.push({ id: handle, name, handle: `@${handle}` }); saveData('satoshisCodexAccounts', X_ACCOUNTS); initializeCarousel(); closeModal('add-account-modal'); e.target.reset(); } });
            
            document.getElementById('add-indicator-form').addEventListener('submit', e => {
                e.preventDefault();
                const desc = document.getElementById('indicator-desc').value;
                const signal = document.getElementById('indicator-signal').value;
                let fullDescription = desc;

                if (signal) {
                    fullDescription += (fullDescription ? ' ' : '') + `Signal: ${signal}`;
                }

                const newInd = {
                    id: 'custom-' + Date.now(),
                    name: document.getElementById('indicator-name').value,
                    externalUrl: document.getElementById('indicator-url').value,
                    category: document.getElementById('indicator-category').value.toLowerCase().trim(),
                    description: fullDescription,
                    icon: 'fas fa-star'
                };
                INDICATORS.push(newInd);
                saveData('satoshisCodexIndicators', INDICATORS);
                indicatorsData.push(newInd);
                handleSearch({ target: { value: document.getElementById('indicator-search').value } });
                updateProgress();
                closeModal('add-indicator-modal');
                e.target.reset();
            });

            document.getElementById('carousel-nav-left').addEventListener('click', () => scrollCarousel(-1));
            document.getElementById('carousel-nav-right').addEventListener('click', () => scrollCarousel(1));

            const menuBtn = document.getElementById('menu-btn');
            const sidebar = document.getElementById('sidebar');
            const sidebarLinks = document.querySelectorAll('.sidebar-link');
            const searchControls = document.getElementById('search-controls');
            const searchToggle = document.getElementById('search-toggle');
            const searchInput = document.getElementById('indicator-search');
            const openIcon = searchToggle.querySelector('.search-open-icon');
            const closeIcon = searchToggle.querySelector('.search-close-icon');

            menuBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                sidebar.classList.toggle('open');
            });

            sidebarLinks.forEach(link => {
                link.addEventListener('click', () => {
                    sidebar.classList.remove('open');
                });
            });

            searchToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                const isActive = searchControls.classList.contains('active');
                if (isActive) {
                    searchInput.value = '';
                    handleSearch({ target: searchInput });
                }
                searchControls.classList.toggle('active');
                openIcon.classList.toggle('hidden');
                closeIcon.classList.toggle('hidden');
                if (!isActive) {
                    searchInput.focus();
                }
            });
            
            document.addEventListener('click', (e) => {
                if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && e.target !== menuBtn) {
                     sidebar.classList.remove('open');
                }
                if (!searchControls.contains(e.target) && searchControls.classList.contains('active')) {
                    searchControls.classList.remove('active');
                    openIcon.classList.remove('hidden');
                    closeIcon.classList.add('hidden');
                }
            });

            const resetButton = document.getElementById('reset-viewed-btn');
            const indicatorsGrid = document.getElementById('indicators-grid');

            resetButton.addEventListener('click', () => {
                viewedIndicators = [];
                saveData('satoshisCodexViewedIndicators', viewedIndicators);
                handleSearch({ target: { value: document.getElementById('indicator-search').value } });
                updateProgress();
            });

            indicatorsGrid.addEventListener('click', (e) => {
                const button = e.target.closest('.mark-viewed-btn');
                if (!button) return;

                const indicatorId = button.dataset.indicatorId;
                const card = e.target.closest('.indicator-card');
                const icon = button.querySelector('i');
                const index = viewedIndicators.indexOf(indicatorId);

                if (index > -1) {
                    viewedIndicators.splice(index, 1);
                    card.classList.remove('viewed');
                    icon.classList.remove('fa-check-circle');
                    icon.classList.add('fa-circle');
                } else {
                    viewedIndicators.push(indicatorId);
                    card.classList.add('viewed');
                    icon.classList.add('fa-check-circle');
                    icon.classList.remove('fa-circle');
                }

                saveData('satoshisCodexViewedIndicators', viewedIndicators);
                updateProgress();
            });
        }
        function handleSearch(e) { const term = e.target.value.toLowerCase(); const activeCat = document.querySelector('.category-btn.active').dataset.category; filteredIndicators = indicatorsData.filter(ind => (activeCat === 'all' || ind.category === activeCat) && (ind.name.toLowerCase().includes(term) || (ind.description && ind.description.toLowerCase().includes(term)))); renderIndicators(); }
        function handleCategoryFilter(cat) { document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active')); document.querySelector(`[data-category="${cat}"]`).classList.add('active'); handleSearch({ target: { value: document.getElementById('indicator-search').value } }); }
        function initializeScrollAnimations() { const obs = new IntersectionObserver(entries => entries.forEach(e => e.isIntersecting && e.target.classList.add('visible')), { threshold: 0.1 }); document.querySelectorAll('.content-section').forEach(sec => obs.observe(sec)); }
        function scrollToSection(id) { document.getElementById(id).scrollIntoView({ behavior: 'smooth' }); }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    </script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</body>
</html>```
