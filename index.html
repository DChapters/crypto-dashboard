<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satoshi's Codex - Pro Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Cormorant+Garamond:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        :root {
            --primary-gold: #B8860B; /* DarkGoldenRod */
            --muted-orange: #D4AF37; /* Muted, antique gold */
            --bitcoin-orange: #F7931A;
            --black: #000000;
            --gray-dark: #101010;
            --gray-light: #1A1A1A;
            --text-primary: #EAEAEA;
            --text-secondary: #888888;
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--black);
            color: var(--text-primary);
            overflow-x: hidden;
            background-image: radial-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 0);
            background-size: 30px 30px;
        }
        
        /* General Styling & Performance */
        .content-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 8rem 1rem;
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .content-section.visible { opacity: 1; transform: translateY(0); }
        .text-gold { color: var(--primary-gold); }
        .bg-gold { background-color: var(--primary-gold); }
        .hover\:bg-muted-orange:hover { background-color: var(--muted-orange); }
        .shadow-gold { box-shadow: 0 0 25px rgba(184, 134, 11, 0.3); }
        .border-gold { border-color: var(--primary-gold); }
        .ring-gold:focus { ring-color: var(--primary-gold); }
        .text-bitcoin { color: var(--bitcoin-orange); }
        /* Title Styles */
        .section-title {
            font-weight: 800;
            letter-spacing: -0.05em;
            background: linear-gradient(135deg, var(--text-primary) 40%, var(--primary-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero-title {
            background: linear-gradient(-45deg, var(--primary-gold), var(--text-primary), var(--muted-orange), var(--text-primary));
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-pan 10s ease infinite;
            line-height: 0.9;
        }
        @keyframes gradient-pan {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        /* X Feed Section - Netflix-style Carousel */
        
        .carousel-container {
            position: relative;
            margin-bottom: 2rem;
        }
        
        .carousel-wrapper {
            overflow: hidden;
            position: relative;
            margin: 0 3rem;
        }
        
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
            gap: 1rem;
        }
        
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            color: var(--text-primary);
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .carousel-nav:hover {
            background-color: rgba(184, 134, 11, 0.8);
            transform: translateY(-50%) scale(1.1);
        }
        
        .carousel-nav-left {
            left: 0;
        }
        
        .carousel-nav-right {
            right: 0;
        }
        
        .carousel-card {
            flex: 0 0 240px; /* Increased card size */
            background-color: var(--gray-light);
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            padding: 2rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .carousel-card:hover {
            transform: translateY(-8px) scale(1.05);
            border-color: var(--primary-gold);
            box-shadow: 0 8px 25px rgba(184, 134, 11, 0.3);
        }
        
        .carousel-card.selected {
            background-color: var(--primary-gold);
            color: var(--black);
            border-color: var(--muted-orange);
            box-shadow: 0 0 20px rgba(184, 134, 11, 0.5);
        }
        
        .carousel-card img {
            width: 80px; /* Increased image size */
            height: 80px; /* Increased image size */
            border-radius: 50%;
            margin-bottom: 1rem;
            border: 2px solid var(--gray-dark);
            margin-left: auto;
            margin-right: auto;
        }
        
        .carousel-card.selected img {
            border-color: var(--black);
        }
        
        .carousel-card h3 {
            font-size: 1.125rem; /* Increased font size */
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .carousel-card p {
            font-size: 0.875rem; /* Increased font size */
            opacity: 0.8;
        }
        /* Scroll Arrow */
        .scroll-arrow {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 1rem;
            border-radius: 50%;
        }
        
        .scroll-arrow:hover {
            transform: translateY(8px) scale(1.1);
            background: rgba(212, 175, 55, 0.1);
        }
        
        /* Skeletons for Loading States */
        .skeleton { 
            background-color: var(--gray-light); 
            border-radius: 0.5rem; 
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite; 
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        /* Accordion & Progress Bar */
        .accordion-header { position: relative; overflow: hidden; cursor: pointer; }
        .progress-bar-inner {
            position: absolute;
            left: 0; top: 0; height: 100%;
            background: linear-gradient(90deg, rgba(184, 134, 11, 0.2) 0%, rgba(184, 134, 11, 0) 100%);
            transition: width 0.5s ease-out;
            z-index: 1;
        }
        .accordion-header > * { position: relative; z-index: 2; }
        .accordion-content { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.5s ease-in-out; 
        }
        .accordion-content.open { max-height: 1000px; }
        
        /* Switch Component */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 28px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        .switch input:checked + .slider { background-color: var(--primary-gold); }
        .switch input:focus + .slider { box-shadow: 0 0 1px var(--primary-gold); }
        .switch input:checked + .slider:before { transform: translateX(22px); }
        
        /* Indicator Cards */
        .indicator-card {
            background-color: rgba(0,0,0,0.3);
            border: 1px solid var(--gray-light);
            border-radius: 0.75rem;
            padding: 1rem;
            flex-basis: calc(33.333% - 1rem);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.3s ease;
            min-height: 200px;
        }
        .indicator-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 0 20px rgba(184, 134, 11, 0.2);
            border-color: rgba(184, 134, 11, 0.5);
        }
        @media (max-width: 1024px) { .indicator-card { flex-basis: calc(50% - 1rem); } }
        @media (max-width: 640px) { .indicator-card { flex-basis: 100%; } }
        /* Price Banner */
        .price-banner { 
            background-color: rgba(0, 0, 0, 0.8); 
            backdrop-filter: blur(12px); 
            overflow: hidden; 
            white-space: nowrap; 
            perspective: 500px;
            border-bottom: 1px solid var(--gray-light);
            font-family: 'Cormorant Garamond', serif;
        }
        .banner-track { 
            display: inline-block; /* Changed for proper marquee */
            animation: marquee 60s linear infinite;
        }
        .banner-segment {
            display: inline-flex;
            align-items: center;
            white-space: nowrap;
        }
        .banner-item { 
            display: inline-flex; 
            align-items: center; 
            font-size: 1.1rem; 
            font-weight: 600;
            transition: transform 0.3s ease; 
        }
        .banner-item:hover { transform: translateY(-2px); }
        
        @keyframes marquee { 
            from { transform: translateX(0); } 
            to { transform: translateX(-50%); } /* Animate by half the width for seamless loop */
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0;
            width: 100%; height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
            align-items: center;
            justify-content: center;
        }
        .modal-content-container {
             width: 100%;
             max-width: 600px;
        }
        .modal-content {
            background-color: var(--gray-dark);
            padding: 2rem;
            border: 1px solid var(--gray-light);
            width: 100%;
            border-radius: 12px;
            animation: slideIn 0.4s ease;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 1rem;
        }
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        .form-input, .form-select {
            width: 100%;
            padding: 0.75rem;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-light);
            border-radius: 0.5rem;
            color: var(--text-primary);
            transition: border-color 0.3s ease;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 0 0 0 2px rgba(184, 134, 11, 0.2);
        }
        .form-select option {
            background-color: var(--gray-dark);
            color: var(--text-primary);
        }
        
        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .btn-primary {
            background-color: var(--primary-gold);
            color: var(--black);
        }
        .btn-primary:hover {
            background-color: var(--muted-orange);
            transform: translateY(-2px);
        }
        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--text-primary);
            border: 1px solid var(--gray-light);
        }
        .btn-secondary:hover {
            border-color: var(--primary-gold);
            transform: translateY(-2px);
        }
        /* Category Filter Styles */
        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
            justify-content: center;
        }
        
        .category-btn {
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            border: 1px solid var(--gray-light);
            background-color: transparent;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }
        
        .category-btn:hover {
            border-color: var(--primary-gold);
        }
        
        .category-btn.active {
            background-color: var(--primary-gold);
            border-color: var(--primary-gold);
            color: var(--black);
        }
        /* Search Styles */
        .search-container {
            position: relative;
            margin-bottom: 2rem;
            max-width: 350px; /* Made search bar smaller */
            margin-left: auto;
            margin-right: auto;
        }
        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem; /* Adjusted padding */
            background-color: var(--gray-light);
            border: 1px solid var(--gray-light);
            border-radius: 0.5rem;
            color: var(--text-primary);
        }
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }
        /* Signal Indicators */
        .signal-indicator {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .signal-buy {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .signal-sell {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .signal-neutral {
            background-color: rgba(136, 136, 136, 0.2);
            color: #888888;
        }
        /* Loading States */
        .loading-spinner {
            border: 2px solid var(--gray-light);
            border-top: 2px solid var(--primary-gold);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Tooltip Styles */
        .tooltip {
            position: relative;
            cursor: help;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--gray-dark);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            border: 1px solid var(--gray-light);
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background-color: var(--primary-gold);
            color: var(--black);
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 20;
        }
        .fab:hover {
            background-color: var(--muted-orange);
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Live Crypto Price Banner -->
    <div class="price-banner py-3 sticky top-0 z-50">
        <div class="banner-track" id="banner-track">
            <!-- Banner items will be populated by JavaScript -->
        </div>
    </div>
    <!-- Hero Section -->
    <section class="content-section hero-section" id="hero">
        <div class="text-center max-w-4xl mx-auto">
            <h1 class="hero-title text-8xl md:text-9xl lg:text-[10rem] font-black mb-6">Satoshi's Codex</h1>
            <!-- Scroll Arrow -->
            <div class="mt-16 flex justify-center">
                <div class="scroll-arrow animate-bounce" onclick="scrollToSection('x-feed')">
                    <i class="fas fa-chevron-down text-5xl text-gold"></i>
                </div>
            </div>
        </div>
    </section>
    <!-- X Feed Section -->
    <section class="content-section" id="x-feed">
        <div class="w-full max-w-7xl mx-auto">
            <h2 class="section-title text-4xl md:text-5xl text-center mb-8">X Feed</h2>
            
            <!-- Netflix-style Carousel -->
            <div class="carousel-container relative">
                <!-- Navigation arrows -->
                <button class="carousel-nav carousel-nav-left" onclick="slideCarousel(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="carousel-nav carousel-nav-right" onclick="slideCarousel(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
                
                <!-- Carousel wrapper -->
                <div class="carousel-wrapper">
                    <div class="carousel-track" id="carousel-track">
                        <!-- Account cards will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            <!-- Selected Feed Content -->
            <div id="x-feed-container" class="mt-4 w-full max-w-lg mx-auto">
                <!-- X Feed will be loaded here -->
            </div>
        </div>
    </section>
    <!-- Trading Indicators Section -->
    <section class="content-section" id="indicators">
        <div class="w-full max-w-7xl mx-auto relative">
            <h2 class="section-title text-4xl md:text-5xl text-center mb-8">Trading Indicators</h2>
            
            <!-- Search and Filter Controls -->
            <div class="search-container">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
                <input type="text" id="indicator-search" class="search-input" placeholder="Search indicators...">
            </div>
            <!-- Category Filters -->
            <div class="category-filter">
                <button class="category-btn active" data-category="all">All</button>
                <button class="category-btn" data-category="sentiment">Sentiment</button>
                <button class="category-btn" data-category="onchain">On-Chain</button>
                <button class="category-btn" data-category="technical">Technical</button>
                <button class="category-btn" data-category="macro">Macro</button>
                <button class="category-btn" data-category="defi">DeFi</button>
                <button class="category-btn" data-category="derivatives">Derivatives</button>
            </div>
            <!-- Indicators Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="indicators-grid">
                <!-- Indicators will be populated by JavaScript -->
            </div>
        </div>
    </section>
    
    <!-- Modals -->
    <div id="indicator-modal" class="modal">
        <div class="modal-content-container p-4">
             <div class="modal-content relative">
                <button type="button" onclick="closeModal('indicator-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20">
                    <i class="fas fa-times fa-lg"></i>
                </button>
                <div id="modal-title-container" class="flex items-center gap-4 mb-4">
                     <i id="modal-icon" class="text-2xl text-gold"></i>
                     <h3 id="modal-title" class="text-xl font-bold text-gold"></h3>
                </div>
                <div id="modal-body">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <div id="add-choice-modal" class="modal">
        <div class="modal-content-container p-4">
            <div class="modal-content relative">
                 <button type="button" onclick="closeModal('add-choice-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20">
                    <i class="fas fa-times fa-lg"></i>
                </button>
                <h3 class="text-xl font-bold text-gold mb-6 text-center">What would you like to add?</h3>
                <div class="flex justify-around gap-4">
                    <button id="add-account-choice-btn" class="btn btn-primary w-full">
                        <i class="fa-brands fa-x-twitter"></i>
                        Account
                    </button>
                    <button id="add-indicator-choice-btn" class="btn btn-secondary w-full">
                        <i class="fas fa-chart-line"></i>
                        Indicator
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="add-account-modal" class="modal">
        <div class="modal-content-container p-4">
            <form id="add-account-form" class="modal-content relative">
                <button type="button" onclick="closeModal('add-account-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20">
                    <i class="fas fa-times fa-lg"></i>
                </button>
                <h3 class="text-xl font-bold text-gold mb-4">Add X Account</h3>
                <div class="form-group">
                    <label for="account-name" class="form-label">Account Name</label>
                    <input type="text" id="account-name" class="form-input" placeholder="e.g., Vitalik Buterin" required>
                </div>
                <div class="form-group">
                    <label for="account-handle" class="form-label">X Handle (without @)</label>
                    <input type="text" id="account-handle" class="form-input" placeholder="e.g., VitalikButerin" required>
                </div>
                <button type="submit" class="btn btn-primary w-full justify-center">Add Account</button>
            </form>
        </div>
    </div>

    <div id="add-indicator-modal" class="modal">
        <div class="modal-content-container p-4">
            <form id="add-indicator-form" class="modal-content relative">
                <button type="button" onclick="closeModal('add-indicator-modal')" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20">
                    <i class="fas fa-times fa-lg"></i>
                </button>
                <h3 class="text-xl font-bold text-gold mb-4">Add Custom Indicator</h3>
                <div class="form-group">
                    <label for="indicator-name" class="form-label">Indicator Name</label>
                    <input type="text" id="indicator-name" class="form-input" required>
                </div>
                 <div class="form-group">
                    <label for="indicator-category" class="form-label">Category</label>
                    <input type="text" id="indicator-category" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="indicator-desc" class="form-label">Description</label>
                    <textarea id="indicator-desc" class="form-input" rows="2"></textarea>
                </div>
                 <div class="form-group">
                    <label for="indicator-signal" class="form-label">Trading Signal</label>
                    <input type="text" id="indicator-signal" class="form-input">
                </div>
                <button type="submit" class="btn btn-primary w-full justify-center">Add Indicator</button>
            </form>
        </div>
    </div>
    
    <button id="global-fab" class="fab">
        <i class="fas fa-plus"></i>
    </button>
    <!-- JavaScript -->
    <script>
        // --- CONFIGURATION --- //
        const API_BASE_URL = 'https://api.coingecko.com/api/v3';
        let INDICATORS = [
             // Sentiment Indicators
            { id: 'fear-greed', name: 'Fear & Greed Index', category: 'sentiment', description: 'Market sentiment indicator. Extreme Fear can be a sign that investors are too worried, presenting a buying opportunity. Extreme Greed indicates the market may be due for a correction.', signal: 'Buy on Extreme Fear (<25), Sell on Extreme Greed (>75)', apiUrl: 'https://api.alternative.me/fng/', icon: 'fas fa-heart-pulse' },
            { id: 'google-trends', name: 'Google Trends', category: 'sentiment', description: 'Tracks search interest for "Bitcoin". A surge in search volume can indicate increased retail interest, often preceding price volatility.', signal: 'High search volume often precedes price movements', icon: 'fab fa-google', externalUrl: 'https://trends.google.com/trends/explore?q=bitcoin&date=today%2012-m' },
            
            // On-Chain Indicators
            { id: 'mvrv-ratio', name: 'MVRV Ratio', category: 'onchain', description: 'Market Value to Realized Value. Compares the total market cap to the "fair value" of Bitcoin. Used to assess if Bitcoin is over or undervalued.', signal: 'MVRV > 3.7 suggests market top, < 1 suggests bottom', icon: 'fas fa-balance-scale', externalUrl: 'https://studio.glassnode.com/metrics?a=BTC&m=market.Mvrv' },
            { id: 'nupl', name: 'Net Unrealized P&L (NUPL)', category: 'onchain', description: 'The difference between market cap and realized cap, divided by market cap. It represents the total paper profits/losses of all Bitcoin holders.', signal: 'High NUPL (>0.75) suggests sell, Low NUPL (<0.25) suggests buy', icon: 'fas fa-chart-line', externalUrl: 'https://studio.glassnode.com/metrics?a=BTC&m=market.Nupl' },
            { id: 'sopr', name: 'Spent Output Profit Ratio (SOPR)', category: 'onchain', description: 'Indicates if holders are selling at a profit or loss. A value above 1 suggests profit-taking, while below 1 suggests panic selling.', signal: 'SOPR > 1 suggests profit-taking, < 1 suggests loss realization', icon: 'fas fa-exchange-alt', externalUrl: 'https://studio.glassnode.com/metrics?a=BTC&m=indicators.Sopr' },
            { id: 'puell-multiple', name: 'Puell Multiple', category: 'onchain', description: 'Looks at the supply side of Bitcoin\'s economy - miners. It compares the daily value of issued bitcoins to the 365-day moving average.', signal: 'Values < 0.5 suggest market bottoms, > 4 suggest tops', icon: 'fas fa-pickaxe', externalUrl: 'https://studio.glassnode.com/metrics?a=BTC&m=mining.PuellMultiple' },
            { id: 'exchange-flows', name: 'Exchange Net Flows', category: 'onchain', description: 'Tracks the net amount of Bitcoin flowing into or out of all exchanges. Sustained outflows are bullish (accumulation), while inflows are bearish (selling pressure).', signal: 'Outflows suggest accumulation, inflows suggest selling pressure', icon: 'fas fa-exchange-alt', externalUrl: 'https://cryptoquant.com/asset/btc/chart/exchange-flows/exchange-netflow-total?window=DAY&sma=0&price=true&exchange=all_exchange&indicator=netflow' },

            // Technical Indicators
            { id: 'rsi', name: 'Relative Strength Index', category: 'technical', description: 'A momentum oscillator that measures the speed and change of price movements on a scale of 0 to 100.', signal: 'RSI > 70 suggests overbought, < 30 suggests oversold', icon: 'fas fa-wave-square' },
            { id: 'macd', name: 'MACD', category: 'technical', description: 'Moving Average Convergence Divergence is a trend-following momentum indicator that shows the relationship between two moving averages of a security’s price.', signal: 'MACD line crossing above signal line suggests bullish momentum', icon: 'fas fa-chart-bar' },
            { id: 'bollinger-bands', name: 'Bollinger Bands', category: 'technical', description: 'Volatility bands placed above and below a moving average. Volatility is based on the standard deviation, which changes as volatility increases and decreases.', signal: 'Price touching lower band suggests oversold condition', icon: 'fas fa-compress-arrows-alt' },

            // Macro Indicators
            { id: 'btc-dominance', name: 'Bitcoin Dominance', category: 'macro', description: 'Bitcoin\'s market cap as a percentage of the total crypto market cap. Its trend can signal the start or end of an "altcoin season".', signal: 'Rising dominance suggests altcoin weakness', icon: 'fab fa-bitcoin' },
            { id: 'etf-flows', name: 'Bitcoin ETF Flows', category: 'macro', description: 'Tracks the daily net inflows and outflows of institutional Bitcoin ETFs. A key indicator of institutional sentiment and adoption.', signal: 'Sustained inflows suggest institutional adoption', icon: 'fas fa-building', externalUrl: 'https://sosovalue.xyz/assets/etf' },

            // Derivatives Indicators
            { id: 'funding-rates', name: 'Perpetual Funding Rates', category: 'derivatives', description: 'Periodic payments exchanged between traders to keep perpetual contract prices close to the spot price. High positive rates suggest overleveraged longs.', signal: 'High positive rates suggest overleveraged longs', icon: 'fas fa-percentage' },
            { id: 'open-interest', name: 'Futures Open Interest', category: 'derivatives', description: 'The total number of outstanding futures contracts that have not been settled. Rising OI with rising price confirms an uptrend.', signal: 'Rising OI with price suggests strong trend', icon: 'fas fa-chart-pie' },
        ];
        let X_ACCOUNTS = [
            { id: 'AugustoBackes', name: 'Augusto Backes', handle: '@AugustoBackes' },
            { id: 'JoshMandell6', name: 'Josh Mandell', handle: '@JoshMandell6' },
            { id: 'CryptoHayes', name: 'Arthur Hayes', handle: '@CryptoHayes' },
            { id: 'DanielLCDuarte', name: 'Daniel Duarte', handle: '@DanielLCDuarte' },
            { id: 'hi_disruptivas', name: 'Disruptivas', handle: '@hi_disruptivas' },
            { id: 'Investidor420', name: 'Investidor420', handle: '@Investidor420' },
            { id: 'castacrypto', name: 'CastaCrypto', handle: '@castacrypto' },
            { id: 'victor__alfa', name: 'Victor Alfa', handle: '@victor__alfa' },
            { id: 'rodrigomcrypto', name: 'RodrigoM.eth', handle: '@rodrigomcrypto' },
            { id: 'joao_wedson', name: 'João Wedson', handle: '@joao_wedson' },
            { id: 'fernandoulrich', name: 'Fernando Ulrich', handle: '@fernandoulrich' },
            { id: 'Felipether', name: 'Felipe Santana', handle: '@Felipether' },
            { id: 'RennoGuil', name: 'Guilherme Renó', handle: '@RennoGuil' },
            { id: 'JA_Maartun', name: 'Maartunn', handle: '@JA_Maartun' },
            { id: 'WatcherGuru', name: 'Watcher.Guru', handle: '@WatcherGuru' },
            { id: 'rovercrc', name: 'Rover', handle: '@rovercrc' },
            { id: 'saylor', name: 'Michael Saylor', handle: '@saylor' },
            { id: 'ParadigmaEdu', name: 'Paradigma Education', handle: '@ParadigmaEdu' },
            { id: 'KobeissiLetter', name: 'The Kobeissi Letter', handle: '@KobeissiLetter' },
            { id: 'bravosresearch', name: 'Bravos Research', handle: '@bravosresearch' },
            { id: 'PositiveCrypto', name: 'Positive Crypto', handle: '@PositiveCrypto' },
            { id: 'Alphractal', name: 'Alphractal', handle: '@Alphractal' },
            { id: 'coinglass_com', name: 'Coinglass', handle: '@coinglass_com' },
            { id: 'cryptoquant_com', name: 'CryptoQuant.com', handle: '@cryptoquant_com' },
            { id: 'alphaextract_', name: 'Alpha Extract', handle: '@alphaextract_' },
            { id: 'ecoinometrics', name: 'Ecoinometrics', handle: '@ecoinometrics' }
        ];

        // --- GLOBAL STATE --- //
        let currentCarouselIndex = 0;
        let selectedAccount = X_ACCOUNTS[0].id;
        let indicatorsData = [...INDICATORS];
        let filteredIndicators = [...indicatorsData];
        let chartInstance = null;

        // --- INITIALIZATION --- //
        document.addEventListener('DOMContentLoaded', () => {
            initializePriceBanner();
            initializeCarousel();
            initializeIndicators();
            initializeScrollAnimations();
            initializeEventListeners();
            startDataUpdates();
        });

        function startDataUpdates() {
            // Update live data every minute
            setInterval(updatePriceBanner, 60000);
            // Refresh indicator data every 5 minutes
            setInterval(() => {
                filteredIndicators.forEach(indicator => loadIndicatorData(indicator.id));
            }, 300000);
        }

        // --- PRICE BANNER --- //
        function initializePriceBanner() {
            updatePriceBanner();
        }

        async function updatePriceBanner() {
            const bannerTrack = document.getElementById('banner-track');
            if (!bannerTrack) return;

            try {
                const coinIds = ['bitcoin', 'ethereum', 'solana'];
                const response = await fetch(`${API_BASE_URL}/simple/price?ids=${coinIds.join(',')}&vs_currencies=usd&include_24hr_change=true`);
                if (!response.ok) throw new Error('Failed to fetch prices');
                const prices = await response.json();

                const fngResponse = await fetch('https://api.alternative.me/fng/?limit=1');
                if (!fngResponse.ok) throw new Error('Failed to fetch F&G');
                const fngData = await fngResponse.json();
                const fngValue = fngData.data[0].value;
                const fngClassification = fngData.data[0].value_classification;

                let segmentHTML = '';

                // BTC
                const btcData = prices['bitcoin'];
                if(btcData) {
                    const btcChange = btcData.usd_24h_change;
                    const btcChangeClass = btcChange >= 0 ? 'text-green-400' : 'text-red-400';
                    const btcChangeIcon = btcChange >= 0 ? '▲' : '▼';
                    segmentHTML += `<span class="banner-item" style="color: #F7931A;">BTC: $${btcData.usd.toLocaleString()}<span class="${btcChangeClass} ml-1">${btcChangeIcon}${Math.abs(btcChange).toFixed(2)}%</span></span>`;
                }

                // Separator
                segmentHTML += `<span class="text-white mx-8">***</span>`;

                // ETH
                const ethData = prices['ethereum'];
                if(ethData) {
                    const ethChange = ethData.usd_24h_change;
                    const ethChangeClass = ethChange >= 0 ? 'text-green-400' : 'text-red-400';
                    const ethChangeIcon = ethChange >= 0 ? '▲' : '▼';
                    segmentHTML += `<span class="banner-item" style="color: #888888;">ETH: $${ethData.usd.toLocaleString()}<span class="${ethChangeClass} ml-1">${ethChangeIcon}${Math.abs(ethChange).toFixed(2)}%</span></span>`;
                }
                
                // Separator
                segmentHTML += `<span class="text-white mx-8">***</span>`;

                // SOL
                const solData = prices['solana'];
                if(solData) {
                    const solChange = solData.usd_24h_change;
                    const solChangeClass = solChange >= 0 ? 'text-green-400' : 'text-red-400';
                    const solChangeIcon = solChange >= 0 ? '▲' : '▼';
                    segmentHTML += `<span class="banner-item" style="color: #9945FF;">SOL: $${solData.usd.toLocaleString()}<span class="${solChangeClass} ml-1">${solChangeIcon}${Math.abs(solChange).toFixed(2)}%</span></span>`;
                }

                // Separator
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                
                // F&G
                let fngColor = '#ef4444'; // Default red for Greed
                if (fngValue <= 45) fngColor = '#10b981'; // Green for Fear
                segmentHTML += `<span class="banner-item" style="color: ${fngColor};">F&G: ${fngValue} ${fngClassification}</span>`;
                
                // Separator
                segmentHTML += `<span class="text-white mx-8">***</span>`;


                // Duplicate for seamless scroll
                bannerTrack.innerHTML = `<div class="banner-segment">${segmentHTML}</div><div class="banner-segment">${segmentHTML}</div>`;
            } catch (error) {
                console.error('Error updating price banner:', error);
                 // Fallback to static data if API fails
                let segmentHTML = '';
                segmentHTML += `<span class="banner-item" style="color: #F7931A;">BTC: $68,123.45<span class="text-red-400 ml-1">▼1.52%</span></span>`;
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                segmentHTML += `<span class="banner-item" style="color: #888888;">ETH: $3,543.21<span class="text-green-400 ml-1">▲0.88%</span></span>`;
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                segmentHTML += `<span class="banner-item" style="color: #9945FF;">SOL: $155.67<span class="text-red-400 ml-1">▼2.10%</span></span>`;
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                segmentHTML += `<span class="banner-item" style="color: #ef4444;">F&G: 52 Neutral</span>`;
                segmentHTML += `<span class="text-white mx-8">***</span>`;
                bannerTrack.innerHTML = `<div class="banner-segment">${segmentHTML}</div><div class="banner-segment">${segmentHTML}</div>`;
            }
        }

        // --- CAROUSEL & X FEED --- //
        function initializeCarousel() {
            const carouselTrack = document.getElementById('carousel-track');
            if (!carouselTrack) return;
            
            carouselTrack.innerHTML = X_ACCOUNTS.map((account, index) => `
                <div class="carousel-card ${index === 0 ? 'selected' : ''}" data-account="${account.id}" onclick="selectAccount('${account.id}', this)">
                    <img src="https://unavatar.io/x/${account.id}" alt="${account.name}" onerror="this.onerror=null;this.src='https://placehold.co/60x60/1A1A1A/EAEAEA?text=${account.name.charAt(0)}';">
                    <h3>${account.name}</h3>
                    <p>${account.handle}</p>
                </div>
            `).join('');
            
            selectAccount(selectedAccount);
        }

        function slideCarousel(direction) {
            const carouselTrack = document.getElementById('carousel-track');
            if (!carouselTrack) return;
            
            const cardWidth = 240 + 16; // card width + gap
            const visibleCards = Math.floor(carouselTrack.parentElement.offsetWidth / cardWidth);
            const maxIndex = Math.max(0, X_ACCOUNTS.length - visibleCards);
            
            currentCarouselIndex = Math.max(0, Math.min(maxIndex, currentCarouselIndex + direction));
            carouselTrack.style.transform = `translateX(${-currentCarouselIndex * cardWidth}px)`;
        }

        function selectAccount(accountId, element) {
            selectedAccount = accountId;
            
            // Update visual selection on carousel
            document.querySelectorAll('.carousel-card').forEach(card => card.classList.remove('selected'));
            if (element) {
                element.classList.add('selected');
            } else {
                const cardToSelect = document.querySelector(`[data-account="${accountId}"]`);
                if(cardToSelect) cardToSelect.classList.add('selected');
            }

            const feedContainer = document.getElementById('x-feed-container');
            const accountInfo = X_ACCOUNTS.find(acc => acc.id === accountId);

            // Set up the container with the timeline embed and a fallback link.
            feedContainer.innerHTML = `
                <div id="timeline-wrapper">
                    <a class="twitter-timeline" data-theme="dark" data-tweet-limit="5" data-height="500" data-chrome="noheader nofooter noborders transparent" href="https://twitter.com/${accountInfo.id}?ref_src=twsrc%5Etfw">
                    </a> 
                </div>
                <div class="mt-4 text-center">
                    <a href="https://twitter.com/${accountInfo.id}" target="_blank" rel="noopener noreferrer" class="btn btn-primary">
                        <i class="fa-brands fa-x-twitter"></i>
                        View on X
                    </a>
                </div>
            `;

            // Reload the Twitter widget to render the new timeline
            if (typeof twttr !== 'undefined' && twttr.widgets) {
                twttr.widgets.load(feedContainer);
            }
        }

        // --- INDICATORS --- //
        function initializeIndicators() {
            renderIndicators();
        }

        function renderIndicators() {
            const grid = document.getElementById('indicators-grid');
            if (!grid) return;
            grid.innerHTML = '';
            
            if (filteredIndicators.length === 0) {
                grid.innerHTML = `<p class="text-center col-span-full text-gray-400">No indicators found.</p>`;
                return;
            }

            filteredIndicators.forEach(indicator => {
                const card = createIndicatorCard(indicator);
                grid.appendChild(card);
                loadIndicatorData(indicator.id);
            });
        }

        function createIndicatorCard(indicator) {
            const card = document.createElement('div');
            card.className = 'indicator-card';
            card.innerHTML = `
                <div>
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <i class="${indicator.icon} text-gold text-lg"></i>
                            <h3 class="font-semibold text-base">${indicator.name}</h3>
                        </div>
                        <div class="tooltip">
                            <i class="fas fa-info-circle text-gray-400"></i>
                            <span class="tooltiptext">${indicator.description}</span>
                        </div>
                    </div>
                    <div class="indicator-value mb-3 text-center" id="value-${indicator.id}">
                        <div class="loading-spinner mx-auto"></div>
                    </div>
                </div>
                <div class="flex justify-between items-center mt-auto">
                    <span class="text-xs text-gray-500 uppercase font-bold">${indicator.category}</span>
                    <button onclick="showIndicatorDetails('${indicator.id}')" class="text-gold hover:text-muted-orange text-sm">
                        Details <i class="fas fa-arrow-right ml-1"></i>
                    </button>
                </div>
            `;
            return card;
        }

        async function loadIndicatorData(indicatorId) {
            const valueElement = document.getElementById(`value-${indicatorId}`);
            if (!valueElement) return;

            const indicator = INDICATORS.find(i => i.id === indicatorId);
            
            try {
                let data;
                if (indicator.id === 'fear-greed') {
                    data = await fetchFearGreedIndex();
                } else if (indicator.id === 'btc-dominance') {
                    data = await fetchBtcDominance();
                } else {
                    // For other indicators, show a placeholder as we don't have live APIs for them
                    data = { value: 'N/A', signal: { type: 'neutral', text: 'View Details' } };
                }

                valueElement.innerHTML = `
                    <div class="text-3xl font-bold ${data.signal.type === 'buy' ? 'text-green-400' : data.signal.type === 'sell' ? 'text-red-400' : 'text-gold'}">
                        ${data.value}
                    </div>
                    <div class="text-sm font-semibold mt-1 signal-indicator signal-${data.signal.type}">
                        ${data.signal.text}
                    </div>
                `;
            } catch (error) {
                console.error(`Error loading data for ${indicatorId}:`, error);
                const data = { value: 'N/A', signal: { type: 'neutral', text: 'Error' } };
                 valueElement.innerHTML = `
                    <div class="text-3xl font-bold text-red-400">
                        ${data.value}
                    </div>
                    <div class="text-sm font-semibold mt-1 signal-indicator signal-sell">
                        ${data.signal.text}
                    </div>
                `;
            }
        }

        async function fetchFearGreedIndex() {
            const response = await fetch('https://api.alternative.me/fng/?limit=1');
            if (!response.ok) throw new Error('F&G API failed');
            const data = await response.json();
            const latest = data.data[0];
            const value = parseInt(latest.value);
            
            let signal = { type: 'neutral', text: latest.value_classification };
            if (value <= 25) signal.type = 'buy';
            else if (value >= 75) signal.type = 'sell';
            
            return { value: value, signal: signal, historical: data.data };
        }
        
        async function fetchBtcDominance() {
            const response = await fetch(`${API_BASE_URL}/global`);
            if (!response.ok) throw new Error('Global data API failed');
            const data = await response.json();
            const dominance = data.data.market_cap_percentage.btc;
            
            return {
                value: `${dominance.toFixed(2)}%`,
                signal: { type: 'neutral', text: 'Dominance' }
            };
        }


        // --- MODAL & DETAILS VIEW --- //
        async function showIndicatorDetails(indicatorId) {
            const indicator = INDICATORS.find(i => i.id === indicatorId);
            if (!indicator) return;

            document.getElementById('modal-title').textContent = indicator.name;
            document.getElementById('modal-icon').className = `${indicator.icon} text-2xl text-gold`;
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = `<div class="flex justify-center items-center p-8"><div class="loading-spinner"></div></div>`;

            document.getElementById('indicator-modal').style.display = 'flex';
            
            let historicalData = null;
            try {
                 if (indicator.id === 'fear-greed') {
                    const fngData = await fetch('https://api.alternative.me/fng/?limit=90');
                    if (!fngData.ok) throw new Error('API failed');
                    const data = await fngData.json();
                    historicalData = data.data.reverse().map(d => ({ x: d.timestamp * 1000, y: parseInt(d.value) }));
                }
            } catch(error) {
                console.error("Failed to load historical data:", error);
                historicalData = null;
            }
           

            modalBody.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <h4 class="font-semibold text-gold mb-1">Description</h4>
                        <p class="text-gray-300 text-sm">${indicator.description}</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gold mb-1">Trading Signal</h4>
                        <p class="text-gray-300 text-sm">${indicator.signal}</p>
                    </div>
                    ${historicalData ? `<div class="my-4"><canvas id="indicator-chart"></canvas></div>` : ''}
                    ${indicator.externalUrl ? `
                        <div>
                            <a href="${indicator.externalUrl}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary mt-4">
                                <i class="fas fa-external-link-alt"></i>
                                View Live Chart
                            </a>
                        </div>
                    ` : ''}
                </div>
            `;

            if (historicalData) {
                renderChart(historicalData);
            }
        }

        function renderChart(data) {
            const ctx = document.getElementById('indicator-chart').getContext('2d');
            if (chartInstance) {
                chartInstance.destroy();
            }
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Fear & Greed Index',
                        data: data,
                        borderColor: 'var(--primary-gold)',
                        backgroundColor: 'rgba(184, 134, 11, 0.2)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            type: 'time',
                            time: { unit: 'month' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: 'var(--text-secondary)' }
                        },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: 'var(--text-secondary)' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            if (modalId === 'indicator-modal' && chartInstance) {
                chartInstance.destroy();
                chartInstance = null;
            }
        }

        // --- EVENT LISTENERS & FILTERS --- //
        function initializeEventListeners() {
            document.getElementById('indicator-search').addEventListener('input', handleSearch);
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => handleCategoryFilter(btn.dataset.category));
            });
            
            // Modal close buttons
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    closeModal(e.target.id);
                }
            });

            // Global Add Button
            document.getElementById('global-fab').addEventListener('click', () => {
                document.getElementById('add-choice-modal').style.display = 'flex';
            });

            // Choice Modal Buttons
            document.getElementById('add-account-choice-btn').addEventListener('click', () => {
                closeModal('add-choice-modal');
                document.getElementById('add-account-modal').style.display = 'flex';
            });

            document.getElementById('add-indicator-choice-btn').addEventListener('click', () => {
                closeModal('add-choice-modal');
                document.getElementById('add-indicator-modal').style.display = 'flex';
            });

            // Form submissions
            document.getElementById('add-account-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('account-name').value;
                const handle = document.getElementById('account-handle').value;
                if (name && handle) {
                    X_ACCOUNTS.push({ id: handle, name: name, handle: `@${handle}` });
                    initializeCarousel();
                    closeModal('add-account-modal');
                    e.target.reset();
                }
            });

            document.getElementById('add-indicator-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const newIndicator = {
                    id: 'custom-' + Date.now(),
                    name: document.getElementById('indicator-name').value,
                    category: document.getElementById('indicator-category').value,
                    description: document.getElementById('indicator-desc').value,
                    signal: document.getElementById('indicator-signal').value,
                    icon: 'fas fa-star' // Default icon
                };
                INDICATORS.push(newIndicator);
                handleSearch({target: {value: ''}}); // Refresh indicators
                closeModal('add-indicator-modal');
                e.target.reset();
            });
        }

        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase();
            const activeCategory = document.querySelector('.category-btn.active').dataset.category;
            
            filteredIndicators = INDICATORS.filter(indicator => {
                const inCategory = activeCategory === 'all' || indicator.category === activeCategory;
                const matchesSearch = indicator.name.toLowerCase().includes(searchTerm) ||
                                      indicator.description.toLowerCase().includes(searchTerm);
                return inCategory && matchesSearch;
            });
            renderIndicators();
        }

        function handleCategoryFilter(category) {
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-category="${category}"]`).classList.add('active');
            
            // Trigger a search reset to apply the new category
            document.getElementById('indicator-search').dispatchEvent(new Event('input'));
        }

        // --- UTILITIES --- //
        function initializeScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.content-section').forEach(section => observer.observe(section));
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }
    </script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</body>
</html>
